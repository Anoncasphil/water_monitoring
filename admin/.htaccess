# Admin Area Security
# Allow access to PHP files but protect sensitive files

# Disable directory browsing
Options -Indexes

# Prevent access to hidden files
<FilesMatch "^\.">
    Order Allow,Deny
    Deny from all
</FilesMatch>

# Security headers
<IfModule mod_headers.c>
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options DENY
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
    Header always set Cache-Control "no-cache, no-store, must-revalidate"
    Header always set Pragma "no-cache"
    Header always set Expires "0"
</IfModule>

# Block access to sensitive files
<FilesMatch "\.(htaccess|htpasswd|ini|log|sh|inc|bak|sql|db)$">
    Order Allow,Deny
    Deny from all
</FilesMatch>

# Allow access to PHP files but protect against direct access to sensitive ones
<FilesMatch "\.(php)$">
    # Allow access to main pages
    <Files "index.php">
        Order Allow,Deny
        Allow from all
    </Files>
    
    # Allow access to dashboard files
    <Files "dashboard.php">
        Order Allow,Deny
        Allow from all
    </Files>
    
    # Allow access to other main admin files
    <Files "monitor.php">
        Order Allow,Deny
        Allow from all
    </Files>
    
    <Files "analytics.php">
        Order Allow,Deny
        Allow from all
    </Files>
    
    <Files "controls.php">
        Order Allow,Deny
        Allow from all
    </Files>
    
    <Files "schedule.php">
        Order Allow,Deny
        Allow from all
    </Files>
    
    <Files "alerts.php">
        Order Allow,Deny
        Allow from all
    </Files>
    
    <Files "user.php">
        Order Allow,Deny
        Allow from all
    </Files>
    
    <Files "actlogs.php">
        Order Allow,Deny
        Allow from all
    </Files>
</FilesMatch>

# Optional: Require authentication for all files
# Uncomment the following lines if you want to add basic authentication
# AuthType Basic
# AuthName "Admin Area"
# AuthUserFile /path/to/.htpasswd
# Require valid-user

# Prevent access from common bots and crawlers
RewriteEngine On
RewriteCond %{HTTP_USER_AGENT} ^$ [OR]
RewriteCond %{HTTP_USER_AGENT} ^(curl|wget|python|java|perl|ruby|php|bot|crawler|spider|scraper) [NC]
RewriteRule .* - [F,L] 